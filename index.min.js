function h(b,a={}){const c=Object.keys(a),d=Object.values(a);try{return new Function(...c,`return \`${b}\`;`)(...d)}catch(f){throw new k(b,a,f)}}class k extends Error{constructor(b,a,c){super();this.name="TemplateError";let d=`
------------------
`;d+=`Template: \`${b}\``,d+=`
------------------
`,d+=`Tags: ${JSON.stringify(a,null,2)}`,d+=`
------------------
`,d+=c,this.message=d}}class i extends HTMLElement{static get observedAttributes(){return["src"]}attributeChangedCallback(b,a,c){if(!this.__initialized)return;a!==c&&(this[b]=c)}get src(){return this.getAttribute("src")}set src(b){this.setAttribute("src",b),this.setSrc(b)}get value(){return this.__data}set value(b){this.setValue(b)}constructor(){super();this.__initialized=!1,this.__theme=null,this.__data=null,this.__table=null,this.__column=null,this.__headers=null,this.__selected=null}async connectedCallback(){this.__table=document.createElement("table"),this.hasAttribute("theme")?(this.__theme=document.createElement("template"),this.__theme.innerHTML=await this.getTheme(),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.__theme.content.cloneNode(!0)),this.shadowRoot.appendChild(this.__table)):this.appendChild(this.__table),this.hasAttribute("src")&&this.setSrc(),this.__initialized=!0}async getTheme(){const b=this.getAttribute("theme"),a=await this.fetchTheme(b);return h(a)}async fetchTheme(b){const a=await fetch(b);if(a.status!==200)throw Error(`ERR ${a.status}: ${a.statusText}`);return a.text()}async setSrc(){this.hasAttribute("src")&&(this.__data=await this.fetchSrc(this.src),this.render())}async fetchSrc(b){const a=await fetch(b);if(a.status!==200)throw Error(`ERR ${a.status}: ${a.statusText}`);return a.json()}setValue(b){this.__data=b,this.render()}sortData(b){if(this.__column===null)return b;const a=this.__column,c=this.__direction,d=c?(f,e)=>f<e:(f,e)=>f>e;return b.sort((f,e)=>d(f[a],e[a])?-1:1)}headerClicked(b){this.__selected=b.target.cellIndex;const a=b.target.cellIndex;this.__direction=a!==this.__column?!0:!this.__direction,this.__column=a,this.render()}styleHeaders(){const b=this.__direction?"asc":"desc",a=this.__direction?"asc":"desc";for(const c of this.__headers.children)c.cellIndex===this.__selected?c.classList.contains(a)?c.classList.remove(a):c.classList.add(b):(c.classList.contains(b)&&c.classList.remove(b),c.classList.contains(a)&&c.classList.remove(a))}render(){let b=[...this.__data];const a=document.createElement("table");this.__headers=document.createElement("tr"),this.__headers.addEventListener("click",e=>this.headerClicked(e));const c=b.shift();c.forEach(e=>{const g=document.createElement("th");g.innerText=e,this.__headers.appendChild(g)}),this.styleHeaders();const d=document.createElement("thead");d.appendChild(this.__headers),a.appendChild(d),b=this.sortData(b);const f=document.createElement("tbody");b.forEach(e=>{const g=document.createElement("tr");e.forEach(l=>{const j=document.createElement("td");j.innerText=l,g.appendChild(j)}),f.appendChild(g)}),a.appendChild(f),this.__theme?(this.shadowRoot.removeChild(this.__table),this.__table=a,this.shadowRoot.appendChild(this.__table)):(this.removeChild(this.__table),this.__table=a,this.appendChild(this.__table))}}customElements.define("wc-sortable-table",i);export{i as WCSortableTable};
